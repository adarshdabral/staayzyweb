module.exports=[26086,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(40695),e=a.i(3130),f=a.i(21958),g=a.i(33217),h=a.i(70025),i=a.i(37927),j=a.i(53250),k=a.i(14501),l=a.i(81010),m=a.i(41675),n=a.i(90166),o=a.i(60246),p=a.i(33441),q=a.i(33508),r=a.i(3314);let s=(0,a.i(70106).default)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);var t=a.i(77156),u=a.i(87682),v=a.i(5522);function w(){let{toast:a}=(0,k.useToast)(),w=(0,i.useQueryClient)(),[x,y]=(0,c.useState)(null),[z,A]=(0,c.useState)(null),[B,C]=(0,c.useState)(""),[D,E]=(0,c.useState)("tenant"),[F,G]=(0,c.useState)(""),{data:H}=(0,g.useQuery)({queryKey:["admin-stats"],queryFn:async()=>(await j.default.get("/admin/dashboard")).data}),{data:I}=(0,g.useQuery)({queryKey:["pending-properties"],queryFn:async()=>(await j.default.get("/admin/properties/pending")).data}),{data:J}=(0,g.useQuery)({queryKey:["admin-complaints"],queryFn:async()=>(await j.default.get("/admin/complaints")).data}),{data:K}=(0,g.useQuery)({queryKey:["admin-users"],queryFn:async()=>(await j.default.get("/admin/users")).data}),{data:L}=(0,g.useQuery)({queryKey:["admin-audit-logs"],queryFn:async()=>(await j.default.get("/admin/audit-logs")).data}),M=(0,h.useMutation)({mutationFn:async a=>j.default.put(`/admin/properties/${a}/approve`),onSuccess:()=>{a({title:"Property approved"}),w.invalidateQueries({queryKey:["pending-properties"]}),w.invalidateQueries({queryKey:["admin-stats"]})},onError:b=>{a({title:"Error",description:b.response?.data?.message||"Failed to approve property",variant:"destructive"})}}),N=(0,h.useMutation)({mutationFn:async({propertyId:a,reason:b})=>j.default.put(`/admin/properties/${a}/reject`,{rejectionReason:b}),onSuccess:()=>{a({title:"Property rejected"}),w.invalidateQueries({queryKey:["pending-properties"]}),w.invalidateQueries({queryKey:["admin-stats"]}),C(""),y(null)},onError:b=>{a({title:"Error",description:b.response?.data?.message||"Failed to reject property",variant:"destructive"})}}),O=(0,h.useMutation)({mutationFn:async({complaintId:a,status:b,notes:c})=>j.default.put(`/admin/complaints/${a}/status`,{status:b,adminNotes:c}),onSuccess:()=>{a({title:"Complaint status updated"}),w.invalidateQueries({queryKey:["admin-complaints"]}),w.invalidateQueries({queryKey:["admin-stats"]}),G(""),A(null)},onError:b=>{a({title:"Error",description:b.response?.data?.message||"Failed to update complaint",variant:"destructive"})}}),P=(0,h.useMutation)({mutationFn:async({userId:a,role:b})=>j.default.put("/admin/users/role",{userId:a,role:b}),onSuccess:()=>{a({title:"User role updated"}),w.invalidateQueries({queryKey:["admin-users"]})},onError:b=>{a({title:"Error",description:b.response?.data?.message||"Failed to update user role",variant:"destructive"})}});return(0,b.jsx)("div",{className:"min-h-screen bg-gray-50 py-12",children:(0,b.jsxs)("div",{className:"container mx-auto px-4",children:[(0,b.jsxs)("div",{className:"mb-8",children:[(0,b.jsx)("h1",{className:"text-4xl font-bold mb-2",children:"Admin Dashboard"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Manage properties, bookings, and users"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,b.jsx)(e.CardTitle,{className:"text-sm font-medium",children:"Total Listings"}),(0,b.jsx)(l.Home,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(e.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:H?.totalListings||0}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:[H?.pendingProperties||0," pending approval"]})]})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,b.jsx)(e.CardTitle,{className:"text-sm font-medium",children:"Total Bookings"}),(0,b.jsx)(m.Calendar,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(e.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:H?.totalBookings||0}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"All time bookings"})]})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,b.jsx)(e.CardTitle,{className:"text-sm font-medium",children:"Total Revenue"}),(0,b.jsx)(n.DollarSign,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(e.CardContent,{children:[(0,b.jsxs)("div",{className:"text-2xl font-bold",children:["₹",(H?.totalRevenue||0).toLocaleString()]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"From all bookings"})]})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,b.jsx)(e.CardTitle,{className:"text-sm font-medium",children:"Total Users"}),(0,b.jsx)(o.Users,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(e.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:H?.totalUsers||0}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:[H?.pendingComplaints||0," pending complaints"]})]})]})]}),(0,b.jsxs)(f.Tabs,{defaultValue:"properties",className:"space-y-6",children:[(0,b.jsxs)(f.TabsList,{children:[(0,b.jsx)(f.TabsTrigger,{value:"properties",children:"Property Approval"}),(0,b.jsx)(f.TabsTrigger,{value:"complaints",children:"Complaints"}),(0,b.jsx)(f.TabsTrigger,{value:"users",children:"User Management"}),(0,b.jsx)(f.TabsTrigger,{value:"audit",children:"Audit Logs"})]}),(0,b.jsxs)(f.TabsContent,{value:"properties",className:"space-y-4",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Pending Property Approvals"}),I?.length>0?(0,b.jsx)("div",{className:"space-y-4",children:I.map(a=>(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsx)(e.CardTitle,{children:a.name}),(0,b.jsxs)(e.CardDescription,{children:[a.nearestCollege," • ",a.distanceFromCollege," km • Owner:"," ",a.owner?.name||"N/A"]})]}),(0,b.jsxs)(e.CardContent,{children:[(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("p",{className:"text-sm font-semibold mb-2",children:"Facilities:"}),(0,b.jsx)("div",{className:"flex flex-wrap gap-2",children:a.facilities?.map((a,c)=>(0,b.jsx)("span",{className:"px-2 py-1 bg-gray-100 rounded text-sm",children:a},c))})]}),a.images&&a.images.length>0&&(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("p",{className:"text-sm font-semibold mb-2",children:"Images:"}),(0,b.jsx)("div",{className:"grid grid-cols-4 gap-2",children:a.images.slice(0,4).map((c,d)=>(0,b.jsx)("div",{className:"h-24 bg-gray-200 rounded overflow-hidden",children:(0,b.jsx)("img",{src:c,alt:`${a.name} ${d+1}`,className:"w-full h-full object-cover"})},d))})]}),(0,b.jsxs)("div",{className:"flex gap-4",children:[(0,b.jsxs)(d.Button,{onClick:()=>M.mutate(a._id),disabled:M.isPending,children:[(0,b.jsx)(p.Check,{className:"h-4 w-4 mr-2"}),"Approve"]}),(0,b.jsxs)(d.Button,{variant:"destructive",onClick:()=>y(a._id),children:[(0,b.jsx)(q.X,{className:"h-4 w-4 mr-2"}),"Reject"]}),(0,b.jsx)("a",{href:`/properties/${a._id}`,target:"_blank",rel:"noopener noreferrer",children:(0,b.jsxs)(d.Button,{variant:"outline",children:[(0,b.jsx)(t.Eye,{className:"h-4 w-4 mr-2"}),"View"]})})]}),x===a._id&&(0,b.jsxs)("div",{className:"mt-4 space-y-2",children:[(0,b.jsx)(v.Input,{placeholder:"Rejection reason",value:B,onChange:a=>C(a.target.value)}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(d.Button,{size:"sm",onClick:()=>N.mutate({propertyId:a._id,reason:B}),disabled:!B||N.isPending,children:"Confirm Rejection"}),(0,b.jsx)(d.Button,{size:"sm",variant:"outline",onClick:()=>{y(null),C("")},children:"Cancel"})]})]})]})]},a._id))}):(0,b.jsx)(e.Card,{children:(0,b.jsx)(e.CardContent,{className:"py-12 text-center",children:(0,b.jsx)("p",{className:"text-gray-600",children:"No pending properties"})})})]}),(0,b.jsxs)(f.TabsContent,{value:"complaints",className:"space-y-4",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Complaint Management"}),J?.length>0?(0,b.jsx)("div",{className:"space-y-4",children:J.map(a=>(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)(e.CardTitle,{children:a.subject}),(0,b.jsx)("span",{className:`px-3 py-1 rounded-full text-sm font-semibold ${"resolved"===a.status?"bg-green-100 text-green-800":"in-progress"===a.status?"bg-blue-100 text-blue-800":"rejected"===a.status?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:a.status.toUpperCase()})]}),(0,b.jsxs)(e.CardDescription,{children:["Property: ",a.property?.name||"N/A"," • Tenant:"," ",a.tenant?.name||"N/A"]})]}),(0,b.jsxs)(e.CardContent,{children:[(0,b.jsx)("p",{className:"mb-4",children:a.description}),a.adminNotes&&(0,b.jsxs)("div",{className:"mb-4 p-3 bg-gray-100 rounded",children:[(0,b.jsx)("p",{className:"text-sm font-semibold mb-1",children:"Admin Notes:"}),(0,b.jsx)("p",{className:"text-sm",children:a.adminNotes})]}),(0,b.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,b.jsx)(d.Button,{size:"sm",onClick:()=>O.mutate({complaintId:a._id,status:"in-progress"}),disabled:O.isPending,children:"Mark In Progress"}),(0,b.jsxs)(d.Button,{size:"sm",variant:"default",onClick:()=>O.mutate({complaintId:a._id,status:"resolved"}),disabled:O.isPending,children:[(0,b.jsx)(p.Check,{className:"h-4 w-4 mr-2"}),"Resolve"]}),(0,b.jsxs)(d.Button,{size:"sm",variant:"destructive",onClick:()=>A(a._id),children:[(0,b.jsx)(q.X,{className:"h-4 w-4 mr-2"}),"Reject"]})]}),z===a._id&&(0,b.jsxs)("div",{className:"mt-4 space-y-2",children:[(0,b.jsx)(v.Input,{placeholder:"Admin notes",value:F,onChange:a=>G(a.target.value)}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(d.Button,{size:"sm",onClick:()=>O.mutate({complaintId:a._id,status:"rejected",notes:F}),disabled:O.isPending,children:"Confirm Rejection"}),(0,b.jsx)(d.Button,{size:"sm",variant:"outline",onClick:()=>{A(null),G("")},children:"Cancel"})]})]})]})]},a._id))}):(0,b.jsx)(e.Card,{children:(0,b.jsx)(e.CardContent,{className:"py-12 text-center",children:(0,b.jsx)("p",{className:"text-gray-600",children:"No complaints"})})})]}),(0,b.jsxs)(f.TabsContent,{value:"users",className:"space-y-4",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"User Management"}),K?.length>0?(0,b.jsx)("div",{className:"space-y-4",children:K.map(a=>(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsx)(e.CardTitle,{children:a.name}),(0,b.jsxs)(e.CardDescription,{children:[a.email," • ",a.phone]})]}),(0,b.jsxs)(e.CardContent,{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(r.Shield,{className:"h-4 w-4 text-gray-500"}),(0,b.jsx)("span",{className:"capitalize font-semibold",children:a.role})]}),"admin"!==a.role&&(0,b.jsxs)(u.Select,{value:D,onValueChange:b=>{E(b),P.mutate({userId:a._id,role:b})},children:[(0,b.jsx)(u.SelectTrigger,{className:"w-[180px]",children:(0,b.jsx)(u.SelectValue,{placeholder:"Change role"})}),(0,b.jsxs)(u.SelectContent,{children:[(0,b.jsx)(u.SelectItem,{value:"tenant",children:"Tenant"}),(0,b.jsx)(u.SelectItem,{value:"owner",children:"Owner"}),(0,b.jsx)(u.SelectItem,{value:"admin",children:"Admin"})]})]})]}),a.referralCode&&(0,b.jsxs)("p",{className:"text-sm text-gray-600 mt-2",children:["Referral Code: ",(0,b.jsx)("code",{className:"font-mono",children:a.referralCode})]})]})]},a._id))}):(0,b.jsx)(e.Card,{children:(0,b.jsx)(e.CardContent,{className:"py-12 text-center",children:(0,b.jsx)("p",{className:"text-gray-600",children:"No users found"})})})]}),(0,b.jsxs)(f.TabsContent,{value:"audit",className:"space-y-4",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Audit Logs"}),L?.length>0?(0,b.jsx)("div",{className:"space-y-2",children:L.map(a=>(0,b.jsx)(e.Card,{children:(0,b.jsx)(e.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-semibold capitalize",children:a.action.replace(/_/g," ")}),(0,b.jsxs)("p",{className:"text-sm text-gray-600",children:[a.resource," ",a.resourceId&&`• ID: ${a.resourceId}`]}),(0,b.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["By ",a.admin?.name||"Unknown"," •"," ",new Date(a.createdAt).toLocaleString()]})]}),(0,b.jsx)(s,{className:"h-5 w-5 text-gray-400"})]})})},a._id))}):(0,b.jsx)(e.Card,{children:(0,b.jsx)(e.CardContent,{className:"py-12 text-center",children:(0,b.jsx)("p",{className:"text-gray-600",children:"No audit logs yet"})})})]})]})]})})}a.s(["default",()=>w],26086)}];

//# sourceMappingURL=app_admin_dashboard_page_tsx_f6179312._.js.map